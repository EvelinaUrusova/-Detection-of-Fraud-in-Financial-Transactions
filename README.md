# -Detection-of-Fraud-in-Financial-Transactions
Это проект в области науки о данных, целью которого является предсказание мошеннических транзакций. Он фокусируется на работе компании Blocker Fraud Company, специализирующейся на выявлении мошенничества в финансовых транзакциях, совершаемых через мобильные устройства.


## 1.0 Бизнес-проблема

Компания Blocker Fraud Company специализируется на выявлении мошенничества в финансовых транзакциях, совершаемых через мобильные устройства. Компания предлагает услугу под названием "Blocker Fraud", которая гарантирует блокировку мошеннических транзакций.

Бизнес-модель компании основана на предоставлении услуг, при этом доход формируется за счет качества оказываемой услуги, то есть пользователь платит фиксированный сбор за успешное обнаружение мошенничества в транзакциях клиента.

Однако, расширяя свое присутствие в Бразилии и стремясь быстрее привлечь клиентов, Blocker Fraud Company приняла очень агрессивную стратегию. Стратегия работает следующим образом:

1. Компания получает 25% от стоимости каждой транзакции, правильно определенной как мошенническая;

2. Компания получает 5% от стоимости каждой транзакции, помеченной как мошенническая, но на самом деле легитимной;

3. Компания возвращает клиенту 100% стоимости за каждую транзакцию, помеченную как легитимная, однако на самом деле являющуюся мошеннической.

С этой агрессивной стратегией компания берет на себя риски неправильного выявления мошенничества и получает вознаграждение за точное обнаружение мошенничества.

Для клиента это отличный вариант сотрудничества с Blocker Fraud Company. Несмотря на высокий сбор за успех в размере 25%, компания снижает свои затраты за счет правильно выявленных мошеннических транзакций, и даже ущерб от ошибок в антимошеннической службе будет покрываться самой Blocker Fraud Company.

Для компании, помимо привлечения большого количества клиентов с помощью этой рискованной стратегии и гарантии возмещения в случае невыявления мошенничества, успех зависит только от точности и достоверности моделей, разработанных ее специалистами по данным. Чем точнее модель "Blocker Fraud", тем выше доход компании. Однако при низкой точности модели компания может понести значительные убытки.

## 2.0 Бизнес-предположения

Предотвращение мошенничества - это реализация стратегии обнаружения мошеннических транзакций или банковских действий и предотвращение этих действий, чтобы избежать финансового ущерба и ущерба репутации клиента и финансового учреждения.

Финансовые мошенничества всегда существуют, и они могут происходить как виртуальными, так и физическими способами. Поэтому инвестиции в безопасность постоянно увеличиваются.

Убытки от мошенничества могут достигать 1 миллиарда реалов, что соответствует половине суммы, которую учреждения инвестируют в технологические системы, направленные на информационную безопасность каждый год, согласно  [Febraban's 2020 Banking Technology Survey](https://blog.simply.com.br/tecnologia-bancaria-2020/).

## 3.0 Стратегия решения

Моим решением этой проблемы будет разработка проекта в области науки о данных. Этот проект будет включать в себя модель машинного обучения, которая может предсказывать, является ли транзакция мошеннической или нет.

**Шаг 01.** Описание данных: На этом первом этапе данные будут собраны и изучены. Отсутствующие значения будут обработаны или удалены. Затем будет проведено первоначальное описание данных, чтобы понять их. Будут выполнены некоторые расчеты описательной статистики, такие как эксцесс, асимметрия, среднее, мода, медиана и стандартное отклонение.

**Шаг 02.** Инженерия признаков: На этом этапе будет создана карта ума для помощи в формировании гипотез и создании новых признаков. Эти предположения помогут в разведывательном анализе данных и могут улучшить показатели модели.

**Шаг 03.** Фильтрация данных: Фильтрация данных используется для удаления столбцов или строк, которые не относятся к бизнесу. Например, столбцы с идентификатором клиента, хэш-кодом или строки с возрастом, который не соответствует человеческому возрасту.

**Шаг 04.** Разведывательный анализ данных: Этот раздел состоит из унивариативного, бивариативного и мультивариативного анализа для помощи в понимании базы данных. Гипотезы, созданные на шаге 02, будут проверены в бивариативном анализе.

**Шаг 05.** Подготовка данных: На этом пятом этапе данные будут подготовлены для моделирования машинного обучения. Следовательно, они будут преобразованы для улучшения обучения модели машинного обучения, таким образом, они могут быть закодированы, увеличены, уменьшены или масштабированы.

**Шаг 06.** Выбор признаков: После подготовки данных на этом этапе алгоритмы, такие как Boruta, выберут лучшие столбцы для обучения модели машинного обучения. Это сокращает размерность базы данных и уменьшает вероятность переобучения.

**Шаг 07.** Моделирование машинного обучения: Шаг 07 направлен на обучение алгоритмов машинного обучения и их способность предсказывать данные. Для валидации модель обучается, проверяется и применяется кросс-валидация, чтобы узнать способность модели к обучению.

**Шаг 08.** Настройка гиперпараметров: После выбора лучшей модели для применения в проекте важно тонко настроить параметры для улучшения ее показателей. Методы оценки производительности модели, применяемые на шаге 07, используются также здесь.

**Шаг 09.** Выводы: На этом этапе заключения проверяется способность модели к генерации результатов с использованием неизвестных данных. Кроме того, на некоторые бизнес-вопросы даются ответы, чтобы показать применимость модели в бизнес-контексте.

**Шаг 10.** Развертывание модели: Это последний этап проекта в области науки о данных. На этом этапе создается API Flask, и модель с функциями сохраняется для внедрения в API.

## 4.0 Топ-3 вывода из данных

* #### Все мошеннические суммы больше 10 000

    **TRUE:** Значения больше 10 000. Но важно отметить, что значения без мошенничества также больше 100 000.

* #### 60% мошеннических транзакций происходят с использованием метода вывода наличных.

    **FALSE:** Мошеннические транзакции происходят при переводах и выводе наличных. Однако их значения почти одинаковы.

* #### Значения больше 100 000 происходят при использовании метода перевода

    **FALSE:** Большинство транзакций происходит при переводах, однако транзакции больше 100 000 также происходят при выводе и вводе наличных.

## 5.0 Machine Learning Applied

Здесь представлены все результаты кросс-валидации моделей машинного обучения с их стандартными параметрами. Метод кросс-валидации важен для демонстрации способности модели к обучению.

#### Dummy Model

| Balanced Accuracy |  Precision  |    Recall   |      F1     |      Kappa     |
|:-----------------:|:-----------:|:-----------:|:-----------:|:--------------:|
|   0.499 +/- 0.0   | 0.0 +/- 0.0 | 0.0 +/- 0.0 | 0.0 +/- 0.0 | -0.001 +/- 0.0 |

#### Logistic Regression

| Balanced Accuracy |  Precision  |      Recall     |        F1       |      Kappa      |
|:-----------------:|:-----------:|:---------------:|:---------------:|:---------------:|
|  0.565 +/- 0.009  | 1.0 +/- 0.0 | 0.129 +/- 0.017 | 0.229 +/- 0.027 | 0.228 +/- 0.027 |

#### K Nearest Neighbors

| Balanced Accuracy |    Precision    |      Recall     |        F1       |      Kappa      |
|:-----------------:|:---------------:|:---------------:|:---------------:|:---------------:|
|  0.705 +/- 0.037  | 0.942 +/- 0.022 | 0.409 +/- 0.074 | 0.568 +/- 0.073 | 0.567 +/- 0.073 |

#### Support Vector Machine

| Balanced Accuracy |  Precision  |     Recall     |        F1        |      Kappa      |
|:-----------------:|:-----------:|:--------------:|:----------------:|:---------------:|
|  0.595 +/- 0.013  | 1.0 +/- 0.0 | 0.19 +/- 0.026 | 0.319 +/- 0.0373 | 0.319 +/- 0.037 |

#### Random Forest

| Balanced Accuracy |    Precision    |      Recall     |        F1       |      Kappa      |
|:-----------------:|:---------------:|:---------------:|:---------------:|:---------------:|
|  0.865 +/- 0.017  | 0.972 +/- 0.014 | 0.731 +/- 0.033 | 0.834 +/- 0.022 | 0.833 +/- 0.022 |

#### XGBoost

| Balanced Accuracy |    Precision    |      Recall     |       F1       |      Kappa     |
|:-----------------:|:---------------:|:---------------:|:--------------:|:--------------:|
|   0.88 +/- 0.016  | 0.963 +/- 0.008 | 0.761 +/- 0.033 | 0.85 +/- 0.023 | 0.85 +/- 0.023 |

#### LightGBM

| Balanced Accuracy |   Precision  |      Recall     |        F1       |      Kappa      |
|:-----------------:|:------------:|:---------------:|:---------------:|:---------------:|
|  0.701 +/- 0.089  | 0.18 +/- 0.1 | 0.407 +/- 0.175 | 0.241 +/- 0.128 | 0.239 +/- 0.129 |

## 6.0 Machine Learning Performance

The chosen model was **XGBoost** and it was tuned to improve their parameters and scores. Below there's a table with the capacity of the model to learn.

| Balanced Accuracy |    Precision    |      Recall     |        F1       |      Kappa      |
|:-----------------:|:---------------:|:---------------:|:---------------:|:---------------:|
|  0.881 +/- 0.017  | 0.963 +/- 0.007 | 0.763 +/- 0.035 | 0.851 +/- 0.023 | 0.851 +/- 0.023 |

It's possible to determinize the capacity of the model to generalize using unseen data. In other words, capcity of the model to classify new data as shown.

| Balanced Accuracy | Precision | Recall |   F1  | Kappa |
|:-----------------:|:---------:|:------:|:-----:|:-----:|
|       0.915       |   0.944   |  0.829 | 0.883 | 0.883 |

## 7.0 Бизнес-результаты

* #### Компания получает 25% от каждой транзакции, правильно определенной как мошенническая.

    Компания может получить 60 613 782,88 реалов, обнаружив мошеннические транзакции.

* #### Компания получает 5% от каждой транзакции, обозначенной как мошенническая, но на самом деле легитимная.

    За ошибочные решения компания может получить R\$ 183,866.98.

* #### Компания возвращает 100% стоимости клиенту за каждую транзакцию, обозначенную как легитимная, однако на самом деле являющуюся мошеннической.

    Компания должна вернуть R\$ 3,546,075.42.

* #### Какова точность и аккуратность модели?

    Для неизвестных данных значения сбалансированной точности составляют 91,5%, а точность - 94,4%.

* #### Насколько надежна модель в классификации транзакций как легитимных или мошеннических?
  
   Модель может обнаружить 76.3% +/- 3.5% of the fraud. Однако она обнаружила 0,829 мошеннических транзакций из неизвестных данных.

* #### Какой доход ожидает компания от классификации 100% транзакций с помощью модели?

    Используя модель, компания может получить доход в размере 60 797 649,86 реалов. Используя текущий метод обнаружения мошенничества, доход составляет 0.00.

* #### Какие убытки ожидает компания, если она классифицирует 100% транзакций с помощью модели?

    За неправильную классификацию компания должна вернуть R\$ 3,546,075.42.  В отличие от этого, при неправильной классификации с использованием текущего метода, компания должна вернуть R\$ 246,001,206.94.

* #### Какую прибыль ожидает компания Blocker Fraud при использовании модели?
  
    Компания может рассчитывать на прибыль в размере R\$ 57,251,574.44. Прибыль от текущего метода составляет R\$ -246,001,206.94.

## 8.0 Выводы

Данные чрезвычайно несбалансированы, однако удалось провести весь анализ данных и создать модель с хорошими показателями.

Компания может ожидать дохода в размере  R\$ 57,251,574.44. Этот результат может продемонстрировать возможности проекта в области науки о данных и помочь компании.

## 9.0 Полученные уроки

* Даже при несбалансированных классах возможно создать модель с хорошими показателями.

* Возможно создать модель, способную классифицировать классы с менее чем 1% образцов.

## 10.0 Следующие шаги

* Протестировать максимум еще 10 гипотез.

* Реализовать техники oversampling или subsampling для улучшения показателей модели.

* Реализовать API на платформе Heroku.
